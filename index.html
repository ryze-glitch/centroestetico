<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=1024, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <meta name="theme-color" content="#141826" />

  <!-- CSP (mettila più restrittiva possibile) [web:210][web:188] -->
  <!-- CAMBIA QUI: https://TUO-WORKER.workers.dev -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    base-uri 'self';
    form-action 'self';
    object-src 'none';
    frame-ancestors 'none';
    img-src 'self' data:;
    style-src 'self';
    script-src 'self';
    connect-src 'self' https://TUO-WORKER.workers.dev;
  " />

  <title>Suite Controllo</title>

  <link rel="manifest" href="./manifest.json" />
  <link rel="stylesheet" href="./style.css" />
</head>

<body>
  <!-- LOGIN MODAL (blocco UI finché non autenticato) -->
  <div class="modal isOpen" id="loginModal" aria-hidden="false">
    <div class="modalCard" role="dialog" aria-modal="true" aria-labelledby="loginTitle" style="width:420px">
      <div class="modalTop">
        <div>
          <div class="modalTitle" id="loginTitle">Accesso</div>
          <div class="muted small">Inserisci utente e PIN.</div>
        </div>
      </div>

      <div class="modalGrid" style="grid-template-columns:1fr">
        <div class="formRow">
          <label class="muted">Utente</label>
          <input id="loginUser" class="input" type="text" autocomplete="username" />
        </div>
        <div class="formRow">
          <label class="muted">PIN</label>
          <input id="loginPin" class="input" type="password" inputmode="numeric" autocomplete="current-password" />
        </div>
        <div class="muted small" id="loginErr" style="display:none;color:#ffb4b4"></div>
      </div>

      <div class="modalBottom">
        <div class="spacer"></div>
        <button class="primaryBtn" id="loginBtn" type="button">Entra</button>
      </div>
    </div>
  </div>

  <div class="app" id="appRoot">
    <aside class="sidebar">
      <div class="brand">
        <div class="brandMark">
          <svg class="i i-22"><use href="#i-slot-brand"></use></svg>
        </div>
        <div class="brandText">
          <div class="brandTitle">Suite Controllo</div>
          <div class="brandSub" id="cabinNameLabel">Cabina 03</div>
        </div>
      </div>

      <nav class="nav">
        <button class="navItem isActive" data-panel="dashboard" type="button">
          <svg class="i"><use href="#i-slot-dashboard"></use></svg>
          <span>Dashboard</span>
        </button>
        <button class="navItem" data-panel="music" type="button">
          <svg class="i"><use href="#i-slot-music"></use></svg>
          <span>Musica</span>
        </button>
        <button class="navItem" data-panel="camera" type="button">
          <svg class="i"><use href="#i-slot-camera"></use></svg>
          <span>Telecamera</span>
        </button>
        <button class="navItem" data-panel="ambience" type="button">
          <svg class="i"><use href="#i-slot-ambience"></use></svg>
          <span>Ambiente</span>
        </button>
        <button class="navItem" data-panel="services" type="button">
          <svg class="i"><use href="#i-slot-services"></use></svg>
          <span>Servizi</span>
        </button>
      </nav>

      <div class="sideFooter">
        <div class="sideStat">
          <div class="sideStatRow">
            <span class="muted">Rete</span>
            <span class="strong" id="sideNet">Online</span>
          </div>
          <div class="sideStatRow">
            <span class="muted">Temperatura</span>
            <span class="strong" id="sideTemp">22°C</span>
          </div>
          <div class="sideStatRow">
            <span class="muted">Volume max</span>
            <span class="strong" id="sideMaxVol">80%</span>
          </div>
        </div>

        <div class="sideClock">
          <div class="clockTime" id="clockTime">--:--</div>
          <div class="clockDate" id="clockDate">---</div>
        </div>

        <button class="sideBtn" id="openSettings" type="button">
          <svg class="i"><use href="#i-settings"></use></svg>
          <span>Impostazioni</span>
        </button>

        <button class="sideBtn" id="logoutBtn" type="button">
          <svg class="i"><use href="#i-x"></use></svg>
          <span>Logout</span>
        </button>
      </div>
    </aside>

    <main class="main">
      <header class="topbar">
        <div class="topLeft">
          <div class="pill" id="netPill">
            <svg class="i i-18" id="netIcon"><use href="#i-wifi"></use></svg>
            <span id="netText">Online</span>
          </div>

          <div class="pill">
            <svg class="i i-18"><use href="#i-timer"></use></svg>
            <span id="timerLabel">Timer: --:--</span>
          </div>

          <div class="pill">
            <svg class="i i-18"><use href="#i-music"></use></svg>
            <span id="musicLabel">Musica: Stop</span>
          </div>
        </div>

        <div class="topRight">
          <button class="iconBtn" id="toggleFullscreen" type="button" title="Schermo intero">
            <svg class="i i-18"><use href="#i-maximize"></use></svg>
          </button>

          <button class="primaryBtn" id="callStaff" type="button">
            <svg class="i i-18"><use href="#i-bell"></use></svg>
            <span>Assistenza</span>
          </button>
        </div>
      </header>

      <section class="panel isActive" id="panel-dashboard">
        <div class="panelHeader">
          <div>
            <h1>Dashboard</h1>
            <p class="sub">Accessi ed eventi vengono loggati su Discord tramite backend proxy.</p>
          </div>
        </div>

        <div class="dashGrid">
          <div class="card dashStatus">
            <div class="dashStatusRow">
              <div class="statusItem">
                <div class="statusLabel muted">Utente</div>
                <div class="statusValue" id="dashUser">-</div>
              </div>
              <div class="statusItem">
                <div class="statusLabel muted">Sessione</div>
                <div class="statusValue mono" id="dashSession">-</div>
              </div>
            </div>

            <div class="dashStatusRow">
              <div class="statusItem">
                <div class="statusLabel muted">Musica</div>
                <div class="statusValue" id="dashNowTrack">Nessun brano</div>
              </div>
              <div class="statusItem">
                <div class="statusLabel muted">Volume</div>
                <div class="statusValue mono" id="dashVol">60%</div>
              </div>
            </div>

            <div class="dashQuickRow">
              <button class="dashMini" id="dashAssist" type="button">
                <svg class="i i-18"><use href="#i-bell"></use></svg><span>Assistenza</span>
              </button>
              <button class="dashMini" id="dashCam" type="button">
                <svg class="i i-18"><use href="#i-slot-camera"></use></svg><span>Ingresso</span>
              </button>
              <button class="dashMini" id="dashMusicToggle" type="button">
                <svg class="i i-18" id="dashMusicIcon"><use href="#i-play"></use></svg><span>Play/Pausa</span>
              </button>
              <button class="dashMini" id="dashLogEvent" type="button">
                <svg class="i i-18"><use href="#i-info"></use></svg><span>Test log</span>
              </button>
            </div>
          </div>

          <div class="card dashShortcuts">
            <div class="cardTop">
              <div class="cardTitle"><svg class="i"><use href="#i-grid"></use></svg><span>Scorciatoie</span></div>
              <div class="muted small">Slot icone pronti (i-slot-tile-*)</div>
            </div>

            <div class="shortcutGrid" id="shortcutGrid">
              <button class="tile" data-action="go:music" type="button">
                <div class="tileIcon"><svg class="i i-22"><use href="#i-slot-tile-1"></use></svg></div>
                <div class="tileText"><div class="tileTitle">Musica</div><div class="tileSub">Playlist & volume</div></div>
              </button>

              <button class="tile" data-action="go:camera" type="button">
                <div class="tileIcon"><svg class="i i-22"><use href="#i-slot-tile-2"></use></svg></div>
                <div class="tileText"><div class="tileTitle">Telecamera</div><div class="tileSub">Ingresso</div></div>
              </button>

              <button class="tile" data-action="go:ambience" type="button">
                <div class="tileIcon"><svg class="i i-22"><use href="#i-slot-tile-3"></use></svg></div>
                <div class="tileText"><div class="tileTitle">Ambiente</div><div class="tileSub">Luci/Clima/Aromi</div></div>
              </button>

              <button class="tile" data-action="go:services" type="button">
                <div class="tileIcon"><svg class="i i-22"><use href="#i-slot-tile-4"></use></svg></div>
                <div class="tileText"><div class="tileTitle">Servizi</div><div class="tileSub">Azioni rapide</div></div>
              </button>
            </div>
          </div>

          <div class="card dashLog">
            <div class="cardTop">
              <div class="cardTitle"><svg class="i"><use href="#i-info"></use></svg><span>Log locale</span></div>
              <button class="ghostBtn" id="clearLog" type="button">Svuota</button>
            </div>
            <div class="logList" id="logList"></div>
          </div>
        </div>
      </section>

      <!-- Sezioni placeholder (ridotte) -->
      <section class="panel" id="panel-music">
        <div class="panelHeader">
          <div><h1>Musica</h1><p class="sub">Placeholder player</p></div>
        </div>
        <div class="card" style="height:calc(100% - 58px)">Da completare.</div>
      </section>

      <section class="panel" id="panel-camera">
        <div class="panelHeader">
          <div><h1>Telecamera</h1><p class="sub">Placeholder</p></div>
        </div>
        <div class="card" style="height:calc(100% - 58px)">Da completare.</div>
      </section>

      <section class="panel" id="panel-ambience">
        <div class="panelHeader">
          <div><h1>Ambiente</h1><p class="sub">Placeholder</p></div>
        </div>
        <div class="card" style="height:calc(100% - 58px)">Da completare.</div>
      </section>

      <section class="panel" id="panel-services">
        <div class="panelHeader">
          <div><h1>Servizi</h1><p class="sub">Placeholder</p></div>
        </div>
        <div class="card" style="height:calc(100% - 58px)">Da completare.</div>
      </section>
    </main>

    <!-- Settings Modal (semplice) -->
    <div class="modal" id="settingsModal" aria-hidden="true">
      <div class="modalCard" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
        <div class="modalTop">
          <div>
            <div class="modalTitle" id="settingsTitle">Impostazioni cabina</div>
            <div class="muted small">Salvate localmente.</div>
          </div>
          <button class="iconBtn" id="settingsClose" type="button"><svg class="i i-18"><use href="#i-x"></use></svg></button>
        </div>

        <div class="modalGrid">
          <div class="formRow">
            <label class="muted">Nome cabina</label>
            <input id="cfgCabinName" class="input" type="text" placeholder="Cabina 03" />
          </div>
        </div>

        <div class="modalBottom">
          <div class="spacer"></div>
          <button class="primaryBtn" id="settingsSave" type="button">Salva</button>
        </div>
      </div>
    </div>
  </div>

  <script src="./app.js"></script>

  <!-- SVG sprite minimale + slot icone -->
  <svg xmlns="http://www.w3.org/2000/svg" style="position:absolute;width:0;height:0;overflow:hidden">
    <symbol id="i-x" viewBox="0 0 24 24"><path d="M18 6L6 18M6 6l12 12" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></symbol>
    <symbol id="i-wifi" viewBox="0 0 24 24"><path d="M5 9a11 11 0 0 1 14 0" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M8.5 12.5a6 6 0 0 1 7 0" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M12 16h0" fill="none" stroke="currentColor" stroke-width="6" stroke-linecap="round"/></symbol>
    <symbol id="i-settings" viewBox="0 0 24 24"><path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z" fill="none" stroke="currentColor" stroke-width="2"/><path d="M19.4 15a7.8 7.8 0 0 0 .1-2l2-1.2-2-3.4-2.3.7a7.7 7.7 0 0 0-1.7-1l-.3-2.4h-4l-.3 2.4a7.7 7.7 0 0 0-1.7 1l-2.3-.7-2 3.4 2 1.2a7.8 7.8 0 0 0 .1 2l-2 1.2 2 3.4 2.3-.7a7.7 7.7 0 0 0 1.7 1l.3 2.4h4l.3-2.4a7.7 7.7 0 0 0 1.7-1l2.3.7 2-3.4-2-1.2z" fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/></symbol>
    <symbol id="i-timer" viewBox="0 0 24 24"><path d="M10 2h4" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M12 14l3-3" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="12" cy="14" r="8" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
    <symbol id="i-maximize" viewBox="0 0 24 24"><path d="M8 3H5a2 2 0 0 0-2 2v3M21 8V5a2 2 0 0 0-2-2h-3M16 21h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></symbol>
    <symbol id="i-bell" viewBox="0 0 24 24"><path d="M18 8a6 6 0 1 0-12 0c0 7-3 7-3 7h18s-3 0-3-7" fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/><path d="M13.7 21a2 2 0 0 1-3.4 0" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></symbol>
    <symbol id="i-grid" viewBox="0 0 24 24"><path d="M4 4h7v7H4V4zm9 0h7v7h-7V4zM4 13h7v7H4v-7zm9 0h7v7h-7v-7z" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
    <symbol id="i-info" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"/><path d="M12 10v7" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M12 7h0" fill="none" stroke="currentColor" stroke-width="6" stroke-linecap="round"/></symbol>
    <symbol id="i-play" viewBox="0 0 24 24"><path d="M8 5l12 7-12 7V5z" fill="currentColor"/></symbol>
    <symbol id="i-music" viewBox="0 0 24 24"><path d="M9 18V6l12-2v12" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="7" cy="18" r="3" fill="none" stroke="currentColor" stroke-width="2"/><circle cx="19" cy="16" r="3" fill="none" stroke="currentColor" stroke-width="2"/></symbol>

    <!-- slots -->
    <symbol id="i-slot-brand" viewBox="0 0 24 24"><path d="M12 2l2.2 6.5L21 9l-5 4 1.5 7L12 17l-5.5 3 1.5-7-5-4 6.8-.5L12 2z" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
    <symbol id="i-slot-dashboard" viewBox="0 0 24 24"><path d="M4 13h7v7H4v-7zm9-9h7v7h-7V4zM4 4h7v7H4V4zm9 9h7v7h-7v-7z" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
    <symbol id="i-slot-music" viewBox="0 0 24 24"><path d="M9 18V6l12-2v12" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="7" cy="18" r="3" fill="none" stroke="currentColor" stroke-width="2"/><circle cx="19" cy="16" r="3" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
    <symbol id="i-slot-camera" viewBox="0 0 24 24"><path d="M4 7h4l2-2h4l2 2h4v12H4V7z" fill="none" stroke="currentColor" stroke-width="2"/><circle cx="12" cy="13" r="3" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
    <symbol id="i-slot-ambience" viewBox="0 0 24 24"><path d="M4 21v-7M4 10V3M12 21v-9M12 8V3M20 21v-5M20 12V3" fill="none" stroke="currentColor" stroke-width="2"/><path d="M2 14h4M10 12h4M18 16h4" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
    <symbol id="i-slot-services" viewBox="0 0 24 24"><path d="M4 4h7v7H4V4zm9 0h7v7h-7V4zM4 13h7v7H4v-7zm9 0h7v7h-7v-7z" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
    <symbol id="i-slot-tile-1" viewBox="0 0 24 24"><path d="M12 6v12M6 12h12" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></symbol>
    <symbol id="i-slot-tile-2" viewBox="0 0 24 24"><path d="M4 7h16v12H4V7z" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
    <symbol id="i-slot-tile-3" viewBox="0 0 24 24"><path d="M4 8h16M4 16h16" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
    <symbol id="i-slot-tile-4" viewBox="0 0 24 24"><path d="M4 4h7v7H4V4zm9 0h7v7h-7V4z" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
  </svg>
</body>
</html>
